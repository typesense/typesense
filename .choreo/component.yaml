name: typesense-server
componentType: service

source:
  repository: https://github.com/kagioshi/typesense
  branch: main
  context: /
  dockerfile: Dockerfile

container:
  ports:
    - containerPort: 8108
  env:
    - name: TYPESENSE_API_KEY
      valueFrom: secret
    - name: TYPESENSE_DATA_DIR
      value: /data
    - name: TYPESENSE_ENABLE_CORS
      value: "true"

scaling:
  minReplicas: 2
  maxReplicas: 5
  policy:
    cpu:
      targetPercentage: 70

endpoints:
  - name: typesense-api
    port: 8108
    type: REST
    networkVisibility: Public
    context: /

observability:
  logging: true
  metrics: true

health:
  readiness:
    httpGet:
      path: /health
      port: 8108
  liveness:
    httpGet:
      path: /health
      port: 8108
